{"version":3,"file":"index-QPKJxFXq.js","sources":["../../src/kaboom_provider.js","../../src/floating_text.js","../../src/scale.js","../../src/spawner.js","../../src/game.js","../../src/main.js"],"sourcesContent":["import kaplay from \"kaplay\";\nexport const k = kaplay();\n","import { k } from \"./kaboom_provider.js\";\n\nexport function floatingText(message, pos, color = k.color(255, 255, 255)) {\n  const txt = k.add([\n    k.text(message, { size: 30, textAlign: \"center\"}),\n    k.pos(pos),\n    color,\n    k.opacity(1),\n    {\n      life: 1,   // seconds before auto-destroy\n      speed: -90 // px per second upwards\n    },\n    \"floatingText\"\n  ]);\n\n  txt.onUpdate(() => {\n    txt.move(0, txt.speed);\n    txt.opacity -= k.dt() / txt.life;\n    if (txt.opacity <= 0) {\n      txt.destroy();\n    }\n  });\n\n  return txt;\n}\n","import { k } from \"./kaboom_provider.js\";\n\nconst lerp = (a, b, t) => a + (b - a) * t;\n\nexport const scale = (obj, start, end, duration, callback) => {\n  let elapsed = 0;\n  console.log(obj.scale);\n  obj.scaleTo(start);\n\n  obj.onUpdate(() => {\n    elapsed += k.dt(); // accumulate time\n    let t = Math.min(elapsed / duration, 1);\n    \n    obj.scaleTo(lerp(start, end, t));\n\n    if (t >= 1) {\n      obj.destroy();\n      if (callback) callback();\n    }\n  });\n};\n","import { k } from \"./kaboom_provider.js\";\n\nexport class Spawner {\n  constructor(spawnTime, timeDecrease, callback) {\n    this.spawnTime = spawnTime\n    this.timeDecrease = timeDecrease\n    this.callback = callback\n    this.active = true\n    this._loop()\n  }\n\n  _loop() {\n    if (!this.active) return\n    this.callback()\n    const nextTime = Math.max(this.spawnTime - this.timeDecrease, this.timeDecrease)\n    k.wait(nextTime, () => {\n      this.spawnTime = nextTime\n      this._loop()\n    })\n  }\n\n  stop() {\n    this.active = false\n  }\n\n  reset(time) {\n    this.spawnTime = time\n    if (!this.active) {\n      this.active = true\n      this._loop()\n    }\n  }\n}\n","import { floatingText } from \"./floating_text.js\";\nimport { k } from \"./kaboom_provider.js\";\nimport { scale } from \"./scale.js\";\nimport { Spawner } from \"./spawner.js\";\n\nlet score = 0;\nconst scoreLabel = k.add([k.text(score), pos(24, 24)]);\n\nk.loadSprite(\"base\", \"sprites/human.png\");\nk.loadSprite(\"bomb\", \"sprites/bomb.png\");\n\nconst minX = 30;\nconst maxX = k.width() - 30;\nconst minY = 30;\nconst maxY = k.height() - 30;\n\nconst rand = (min, max) => Math.random() * (max - min) + min;\n\nconst getRekt = (size) =>\n  new k.Polygon([\n    k.vec2(-size, size),\n    k.vec2(size, size),\n    k.vec2(size, -size),\n    k.vec2(-size, -size),\n  ]);\n\nconst spawnHuman = () => {\n  const x = rand(minX, maxX);\n  const y = rand(minY, maxY);\n  const human = k.add([\n    k.pos(x, y),\n    k.anchor(\"center\"),\n    k.sprite(\"base\"),\n    k.scale(1),\n    k.area(),\n    \"human\",\n  ]);\n\n  scale(human, 1, 1.5, 3, () => {\n    k.quit();\n  });\n};\n\nconst spawnBomb = () => {\n  const x = rand(minX, maxX);\n  const y = rand(minY, maxY);\n  const bomb = k.add([\n    k.pos(x, y),\n    k.sprite(\"bomb\"),\n    k.scale(1),\n    k.anchor(\"center\"),\n    k.area(),\n    \"bomb\",\n  ]);\n\n  scale(bomb, 1, 1.5, 3, () => {});\n};\n\nk.onClick(\"human\", (human) => {\n  console.log(\"click\");\n  score++;\n  scoreLabel.text = score;\n  human.destroy();\n  k.addKaboom(human.pos, { scale: 0.5, speed: 2 });\n  floatingText(\"БРОК!\", human.pos, k.color(255, 0, 0));\n});\n\nk.onClick(\"bomb\", () => {\n  k.quit();\n});\n\nnew Spawner(3, 0.1, spawnHuman);\nk.wait(5, () => new Spawner(6, 0.5, spawnBomb));\n","import { k } from \"./kaboom_provider.js\";\n\nk.loadSprite(\"base\", \"sprites/human.png\")\nk.loadSprite(\"bomb\", \"sprites/bomb.png\")\n\nimport './game.js';\n"],"names":["k","kaplay","floatingText","message","pos","color","txt","lerp","a","b","t","scale","obj","start","end","duration","callback","elapsed","Spawner","spawnTime","timeDecrease","nextTime","time","score","scoreLabel","minX","maxX","minY","maxY","rand","min","max","spawnHuman","x","y","human","spawnBomb","bomb"],"mappings":"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"}